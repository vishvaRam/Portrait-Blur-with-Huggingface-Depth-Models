# Depth-Based Portrait Blurring

This project provides tools for depth-based portrait blurring using huggingface's apple/DepthPro and Depth-anything models. It includes implementations for generating depth maps and applying portrait blur effects to images.

### Key Components

- **Depth Estimation**: 
  - [`AppleDepthEstimator`](Cont/Code/Model/appleDepthPro.py): Uses the `apple/DepthPro-hf` model for depth estimation.
  - Hugging Face's `depth-anything/Depth-Anything-V2-Large-hf` pipeline for depth estimation.

- **Portrait Blurring**:
  - [`ApplePortraitBluer`](Cont/Code/Portrait/applePortrait.py): Applies portrait blur using depth maps generated by `AppleDepthEstimator`.
  - [`DepthAnythingPortraitBluer`](Cont/Code/Portrait/depthAnythingPortrait.py): Applies portrait blur using depth maps from the `depth-anything` pipeline.

- **Main Script**:
  - [`main.py`](Cont/Code/main.py): Demonstrates the usage of depth estimation and portrait blurring.

## Prerequisites

- Python 3.12
- NVIDIA GPU with CUDA support (optional but recommended for faster processing)

## Installation

1. Clone the repository.
2. Navigate to the `Cont/Code` directory.
3. Install dependencies:
   ```bash
   pip install -r requirements.txt
   ```

## Usage

### Running Locally

1. Place your input image in the `Images/` directory.
2. Update the `image_path` variable in `main.py` with the path to your image.
3. Run the script:
   ```bash
   python main.py
   ```
4. The output depth map and blurred portrait will be saved in the Output/ directory.

## Running with Docker

1. Build the Docker container:
```bash
sudoo docker compose build
```
2. Run the Docker container:
```bash
sudoo docker compose up
```
